---
layout: post
title:  IOS开发旅程
categories: ios
tags:
author: kongkongye
---

* content
{:toc}

包含一些自我的想法,与熟悉的java语言的比较,项目的进化旅程等.




## 使用什么语言开发IOS应用?
`Objective-C`或`Swift`,考虑到Objc比较成熟稳定,Swift则相对比较新,
因此在语言上打算先学Objc,等熟悉了再尝试Swift(这也是网上大部分人的推荐).

但对于比较新的,更简洁优雅的,从Objc的经验上催生的Swift,的确应该抱着谦虚的态度去学习.

## 使用什么IDE(集成开发环境)?
苹果官方出的`XCode`,这个没什么好说的.

## Git支持?
目前XCode新建项目时自带了初始化Git的选项,并且XCode已经集成了Git功能,比如修改的文件会显示`M`,新增的文件会显示`A`.
这说明Git是可行并且是官方推荐的.
对于常用简单的git操作,XCode自带的已经可以了,当然复杂的git操作可以用命令行或其它git工具进行.

只是`.gitignore`文件仍然需要自己建立,至于内容,则直接参考[gitignore](https://github.com/github/gitignore)上的`Objective-C.gitignore`.

## Objc是什么?怎么学?
首先看字面上的意思 -- 面向对象的C,即它是`C`语言的扩展,在其上添加了`面向对象`(OOP)特性.
事实上,Objc是C语言的严格超集.

至于添加的面向对象特性,可以简单的概括为3点:

1. 封装: 就是把`数据`与`方法`打包在一起,对外隐藏具体实现.
2. 继承: 利用现有类的功能,无需重新编写相同的代码,对现有功能进行扩展.
3. 多态: 主要包括`覆盖`与`重载`,覆盖就是子类重新定义父类的方法,重载就是允许存在多个名字相同的函数,但参数不同.

  但要注意的是,在Objc里并不存在重载,因为它只认函数名,不认参数类型.

## 包与命名空间?
不像java有`包`,c++有`命名空间`,Objc里没有这种机制...(听说这个点是争论比较大的)

但替代的,Objc里通常以`前缀`来区分.比如官方核心的`NS`前缀,像`NSObject`,`NSArray`等.

前缀冲突怎么办?这个没什么办法,官方建议`两个字母`作为前缀的类名是为官方的库与框架准备的;第三方库应该使用`三个或更多字母`来作为前缀

除了`类名`,`方法名`也应该加前缀(这个甚至更严重?!),否则...一旦冲突,自己cry吧.

## objc有哪些数据类型?
objc是C语言的超集,那么先说说C语言有哪些数据类型:

1. 基本数据类型
  * 整数
    * char
    * short
    * int
    * long
    * ...
  * 浮点数
    * float
    * double
    * ...
  * bool
2. 枚举
3. void: 没有值,通常用于以下情形:
  1. 函数返回为空
  2. 函数参数为空
  3. 指针指向void(类型为void \*)
4. 派生类型
  * 指针pointer
  * 数组
  * 结构struct
  * 共用体union
  * 函数function (指函数返回值类型)

数组与结构类型统称为`聚合`类型.

然后objc附加了以下的数据类型:

1. 派生类型
  * NSValue: 这是个可以和各种基本数据类型互转的类
  * NSNumber: 继承自NSValue,数字的包装类
  * NSString: 这是一个类,基本上代替了char与string的使用
  * NSArray: 数组
  * ...
2. id类型: 表示任意类型(只表示对象类型,不表示基本数据类型),类型于js语言的var

objc类型封装?
objc在c的基础上,对类型作了一些封装(其实就是别名),如`int`与`NSInteger`,`float`与`CGFloat`等.
那么使用原始的类型还是封装的类型更好呢?
推荐使用封装的类型,这样可以屏蔽底层实现细节.

`NSInteger`与`NSNumber`的区别?
NSInteger是数据类型,而NSNumber是一个类.
比如NSArray里只能放类,因此`3`这样的基础数据类型是无法放入的,而包装成`@3`类后即可放入.

ps: 数据类型这块还是比较乱,后面再整理

## 内存管理
对c语言来说,内存需要手动分配与释放,因此在objc里也类似.
在objc里,内存管理主要靠`retain count`(引用计数),在`alloc`,`retain`,`copy`时会加1,在`release`时会减1.

#### 问题是什么?
内存管理主要有两个问题:

1. 释放正在使用的对象: 程序崩溃
2. 未释放不再使用的对象: 内存泄露

#### 规则是什么?
内存管理的规则也很简单:

1. 我们拥有创建的对象,不再使用时必须进行释放
2. retain后不再使用时也必须release
3. 不释放非自己拥有的对象

为了加深理解,举个例子,新建一个NSURLConnection连接,但是请求是异步返回的,那什么时候释放呢?
很简单,NSURLConnection对象用完就释放,它会在发送请求时将自己retain一次,请求返回时又会自动release一次.
因此你不用理它,管好自己就行,用完就释放.

#### ARC(Automic Reference Counting)
新版本的objc引入了ARC,管理内存的自动释放(对应的是MRC).

要注意的是这个是在`编译`时期(而非运行时期)自动在代码中插入合适的内存管理代码(类似插入retain,release,autorelease吧).
此外在运行期也会有一些优化.

## 项目文件结构
目标:

1. 目录结构清晰
2. 快速找到文件
3. 减少依赖,增加可移植性

基本概念:

* 主要的项目功能: 外层先按`功能模块`分,内层再按`MVC`分.
* 工具类等功能: 单独的目录.
* 模块内可以包含子模块,但建议层次不超过三级.

具体结构设计:

* `Class`: 存放所有模块功能
* `Base`: 存放基类
* `Vendor`: 第三方(主要的第三方用cocoapods,小的放这里)
* `Framework`: 类库
* `Resource`: 存放资源
* `Support`: 工具类,分类,宏定义,PCH文件等
* `Main`: AppDelegate相关

## XCode项目结构
* Workspace: 就是工作空间,里面可以包含多个项目,为什么?比如这些项目间有关联.
  * Project: 项目的意思(这才是主体),包含构建一个或多个软件产品所需的所有文件,资源和信息
    * Target: 指定要构建的产品,并包含构建需要的文件说明.target之间可以互相独立或依赖.
* Scheme: 定义可构建的Target以及构建时使用的构建信息

在`Project Navigator`中,选择项目,右侧会展示`Project Editor`,这里可以看到所有的Target.
此外,可以看到产品信息和构建配置(Build Settings),其中构建配置内的大部分配置项还区分`Debug`与`Release`.
Debug就是多输出一些调试信息,Release会进行代码优化.

关于Workspace的作用,可以拿Cocospods举例,
当使用Cocospods来管理第三方时,会自动新建一个跟原项目平行的Pods项目,里面放置第三方依赖.
原先打开的是一个名为`app.xcodeproj`的`项目`,现在改为打开cocospods自动生成的名为`app.xcworkspace`的`工作空间`,
工作空间里有原来的项目,与放置第三方依赖的Pods项目.

Target使用场景?

1. 用来区分免费版与收费版,主体上功能差不多,一些地方有区别.
2. 用来区分开发与生产环境
3. 用来区分ios与ipad?

Scheme使用场景?

1. 打测试包与正式包
